<!--
  ESET Remote rules
  Created by Wazuh, Inc.
  Copyright (C) 2015-2021, Wazuh Inc.
  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!-- 
  Description:
  - This ruleset evaluates logs decoded by 0575-eset-remote-decoders.xml to trigger alerts
    based on the rules below.
  - The reference below shows some events, their main parts and their different log types.
    Reference: https://help.eset.com/protect_admin/81/en-US/events-exported-to-json-format.html
  
  Software details: 
  - These rules were created using logs from the software with the following details:
    Software Name: ESET Remote Administrator
    Software Version: 8.1
-->

<group name="eset,">

  <rule id="42001" level="0">
    <decoded_as>eset-bsd</decoded_as>
    <description>Eset console logs.</description>
  </rule>

  <rule id="42002" level="3">
    <if_sid>42001</if_sid>
    <field name="event_type">^Threat_Event$</field>
    <description>Eset: Threat event rules group.</description>
    <group>threat_event,</group>
  </rule>

  <rule id="42003" level="3">
    <if_sid>42001</if_sid>
    <field name="event_type">^FirewallAggregated_Event$</field>
    <description>Eset: Firewall aggregated rules group.</description>
    <group>firewallaggregated_event,</group>
  </rule>

  <rule id="42004" level="3">
    <if_sid>42001</if_sid>
    <field name="event_type">^HipsAggregated_Event$</field>
    <description>Eset: HIPS aggregated rules group.</description>
    <group>hipsaggregated_event,</group>
  </rule>

  <rule id="42005" level="2">
    <if_sid>42001</if_sid>
    <field name="event_type">^Audit_Event$</field>
    <description>Eset: Audit rules group.</description>
    <group>audit_event,</group>
  </rule>

  <rule id="42006" level="3">
    <if_sid>42001</if_sid>
    <field name="event_type">^EnterpriseInspectorAlert_Event$</field>
    <description>Eset: Enterprise inspector alert rules group.</description>
    <group>enterpriseinspectoralert_event,</group>
  </rule>

  <rule id="42007" level="5">
    <if_sid>42001</if_sid>
    <field name="severity">^Warning$</field>
    <description>Eset: Warning message was logged from $(hostname).</description>
  </rule>

  <rule id="42008" level="7">
    <if_sid>42001</if_sid>
    <field name="severity">^Error$</field>
    <description>Eset: Error message was logged from $(hostname).</description>
  </rule>

  <rule id="42009" level="12">
    <if_sid>42001</if_sid>
    <field name="severity">^Critical$</field>
    <description>Eset: Critical message was logged from $(hostname).</description>
  </rule>

</group>
